[92mINFO [0m:      Saving logs to /home/tanglc/Flower_Experiment/fully_local_3_clients(1)/2025-07-02/18-02-24
[2025-07-02 18:02:24,532][flwr][INFO] - Saving logs to /home/tanglc/Flower_Experiment/fully_local_3_clients(1)/2025-07-02/18-02-24
[92mINFO [0m:      ------------------ Training Client 1 ------------------
[2025-07-02 18:02:24,532][flwr][INFO] - ------------------ Training Client 1 ------------------
Using the latest cached version of the dataset since uoft-cs/cifar10 couldn't be found on the Hugging Face Hub
[2025-07-02 18:02:24,556][datasets.load][WARNING] - Using the latest cached version of the dataset since uoft-cs/cifar10 couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'plain_text' at /home/tanglc/.cache/huggingface/datasets/uoft-cs___cifar10/plain_text/0.0.0/0b2714987fa478483af9968de7c934580d0bb9a2 (last modified on Tue Jul  1 16:57:22 2025).
[2025-07-02 18:02:24,557][datasets.packaged_modules.cache.cache][WARNING] - Found the latest cached dataset configuration 'plain_text' at /home/tanglc/.cache/huggingface/datasets/uoft-cs___cifar10/plain_text/0.0.0/0b2714987fa478483af9968de7c934580d0bb9a2 (last modified on Tue Jul  1 16:57:22 2025).
/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/utils/_dill.py:385: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/utils/_dill.py:385: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
[92mINFO [0m:      Epoch 11/200, Loss: 0.2641, Test Accuracy: 0.7391
[2025-07-02 18:02:39,649][flwr][INFO] - Epoch 11/200, Loss: 0.2641, Test Accuracy: 0.7391
[92mINFO [0m:      Epoch 21/200, Loss: 0.0791, Test Accuracy: 0.7736
[2025-07-02 18:02:52,783][flwr][INFO] - Epoch 21/200, Loss: 0.0791, Test Accuracy: 0.7736
[92mINFO [0m:      Epoch 31/200, Loss: 0.0469, Test Accuracy: 0.7879
[2025-07-02 18:03:05,987][flwr][INFO] - Epoch 31/200, Loss: 0.0469, Test Accuracy: 0.7879
[92mINFO [0m:      Epoch 41/200, Loss: 0.0231, Test Accuracy: 0.7661
[2025-07-02 18:03:19,207][flwr][INFO] - Epoch 41/200, Loss: 0.0231, Test Accuracy: 0.7661
[92mINFO [0m:      Epoch 51/200, Loss: 0.0207, Test Accuracy: 0.7796
[2025-07-02 18:03:32,358][flwr][INFO] - Epoch 51/200, Loss: 0.0207, Test Accuracy: 0.7796
[92mINFO [0m:      Epoch 61/200, Loss: 0.0063, Test Accuracy: 0.7946
[2025-07-02 18:03:45,434][flwr][INFO] - Epoch 61/200, Loss: 0.0063, Test Accuracy: 0.7946
[92mINFO [0m:      Epoch 71/200, Loss: 0.0084, Test Accuracy: 0.7894
[2025-07-02 18:03:58,625][flwr][INFO] - Epoch 71/200, Loss: 0.0084, Test Accuracy: 0.7894
[92mINFO [0m:      Epoch 81/200, Loss: 0.0078, Test Accuracy: 0.7789
[2025-07-02 18:04:11,701][flwr][INFO] - Epoch 81/200, Loss: 0.0078, Test Accuracy: 0.7789
[92mINFO [0m:      Epoch 91/200, Loss: 0.0030, Test Accuracy: 0.7871
[2025-07-02 18:04:24,697][flwr][INFO] - Epoch 91/200, Loss: 0.0030, Test Accuracy: 0.7871
[92mINFO [0m:      Epoch 101/200, Loss: 0.0023, Test Accuracy: 0.7924
[2025-07-02 18:04:37,868][flwr][INFO] - Epoch 101/200, Loss: 0.0023, Test Accuracy: 0.7924
[92mINFO [0m:      Epoch 111/200, Loss: 0.0024, Test Accuracy: 0.7991
[2025-07-02 18:04:51,008][flwr][INFO] - Epoch 111/200, Loss: 0.0024, Test Accuracy: 0.7991
[92mINFO [0m:      Epoch 121/200, Loss: 0.0018, Test Accuracy: 0.7864
[2025-07-02 18:05:04,133][flwr][INFO] - Epoch 121/200, Loss: 0.0018, Test Accuracy: 0.7864
[92mINFO [0m:      Epoch 131/200, Loss: 0.0025, Test Accuracy: 0.7894
[2025-07-02 18:05:17,238][flwr][INFO] - Epoch 131/200, Loss: 0.0025, Test Accuracy: 0.7894
[92mINFO [0m:      Epoch 141/200, Loss: 0.0019, Test Accuracy: 0.7886
[2025-07-02 18:05:30,241][flwr][INFO] - Epoch 141/200, Loss: 0.0019, Test Accuracy: 0.7886
Traceback (most recent call last):
  File "/home/tanglc/Flower_Experiment/FedPer/./baselines/fully_local.py", line 108, in <module>
    main()
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/FedPer/./baselines/fully_local.py", line 79, in main
    for batch in trainloader:
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 50, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2766, in __getitems__
    batch = self.__getitem__(keys)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2762, in __getitem__
    return self._getitem(key)
           ^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2747, in _getitem
    formatted_output = format_table(
                       ^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 639, in format_table
    return formatter(pa_table, query_type=query_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 407, in __call__
    return self.format_batch(pa_table)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/formatting/formatting.py", line 522, in format_batch
    return self.transform(batch)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/FedPer/fedper/utils.py", line 74, in apply_transforms
    batch["img"] = [pytorch_transforms(img) for img in batch["img"]]
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
          ^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torchvision/transforms/transforms.py", line 277, in forward
    return F.normalize(tensor, self.mean, self.std, self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torchvision/transforms/functional.py", line 350, in normalize
    return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/torchvision/transforms/_functional_tensor.py", line 928, in normalize
    return tensor.sub_(mean).div_(std)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[92mINFO [0m:      Saving logs to /home/tanglc/Flower_Experiment/fully_local_3_clients(1)/2025-07-02/18-05-47
[2025-07-02 18:05:47,295][flwr][INFO] - Saving logs to /home/tanglc/Flower_Experiment/fully_local_3_clients(1)/2025-07-02/18-05-47
[92mINFO [0m:      ------------------ Training Client 0 ------------------
[2025-07-02 18:05:47,295][flwr][INFO] - ------------------ Training Client 0 ------------------
Using the latest cached version of the dataset since uoft-cs/cifar10 couldn't be found on the Hugging Face Hub
[2025-07-02 18:05:47,334][datasets.load][WARNING] - Using the latest cached version of the dataset since uoft-cs/cifar10 couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'plain_text' at /home/tanglc/.cache/huggingface/datasets/uoft-cs___cifar10/plain_text/0.0.0/0b2714987fa478483af9968de7c934580d0bb9a2 (last modified on Tue Jul  1 16:57:22 2025).
[2025-07-02 18:05:47,334][datasets.packaged_modules.cache.cache][WARNING] - Found the latest cached dataset configuration 'plain_text' at /home/tanglc/.cache/huggingface/datasets/uoft-cs___cifar10/plain_text/0.0.0/0b2714987fa478483af9968de7c934580d0bb9a2 (last modified on Tue Jul  1 16:57:22 2025).
/home/tanglc/Flower_Experiment/flower_env/lib/python3.12/site-packages/datasets/utils/_dill.py:385: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
[92mINFO [0m:      Epoch 11/200, Loss: 0.8788, Test Accuracy: 0.5491
[2025-07-02 18:07:07,697][flwr][INFO] - Epoch 11/200, Loss: 0.8788, Test Accuracy: 0.5491
[92mINFO [0m:      Epoch 21/200, Loss: 0.4430, Test Accuracy: 0.5575
[2025-07-02 18:08:19,011][flwr][INFO] - Epoch 21/200, Loss: 0.4430, Test Accuracy: 0.5575
[92mINFO [0m:      Epoch 31/200, Loss: 0.2289, Test Accuracy: 0.5664
[2025-07-02 18:09:28,961][flwr][INFO] - Epoch 31/200, Loss: 0.2289, Test Accuracy: 0.5664
[92mINFO [0m:      Epoch 41/200, Loss: 0.1511, Test Accuracy: 0.5597
[2025-07-02 18:10:39,221][flwr][INFO] - Epoch 41/200, Loss: 0.1511, Test Accuracy: 0.5597
[92mINFO [0m:      Epoch 51/200, Loss: 0.0863, Test Accuracy: 0.5847
[2025-07-02 18:11:50,484][flwr][INFO] - Epoch 51/200, Loss: 0.0863, Test Accuracy: 0.5847
